import os
from openai import OpenAI
from dotenv import load_dotenv

load_dotenv()
client = OpenAI(api_key=os.getenv('OPENAI_API_KEY'))

def summarize_text(text, summary_length="short"):
    """텍스트 요약 함수"""
    
    length_instructions = {
        "short": "3-5줄로 간단히",
        "medium": "한 문단(5-8줄)으로", 
        "long": "2-3문단으로 상세히"
    }
    
    prompt = f"""
다음 텍스트를 {length_instructions.get(summary_length, "간단히")} 요약해주세요:

원문:
{text}

요약 시 다음을 포함해주세요:
- 핵심 주제와 메시지
- 주요 데이터나 수치 (있는 경우)
- 결론 또는 시사점
"""

    try:
        response = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=[{"role": "user", "content": prompt}],
            max_tokens=300,
            temperature=0.3
        )
        
        return response.choices[0].message.content
    
    except Exception as e:
        return f"요약 중 오류 발생: {str(e)}"

# 사용 예시
if __name__ == "__main__":
    long_article = """
    여기에 긴 기사나 문서를 넣어서 테스트해보세요.
    """
    
    summary = summarize_text(long_article, "medium")
    print("📄 요약 결과:")
    print(summary)



    """
    - 입력 텍스트(long_article) 
        - 2025년 상반기, 전 세계적으로 에너지 가격이 급등하면서 각국은 신재생에너지 전환 정책에 속도를 내기 시작했다. 
        특히 유럽연합(EU)은 풍력 및 태양광 에너지 비율을 전체 에너지 소비의 50% 이상으로 끌어올리겠다는 계획을 발표했다. 
        그러나 일각에서는 여전히 신재생에너지의 안정성, 저장 문제, 초기 투자 비용 등에 대한 우려를 제기하고 있다.

        전문가들은 이러한 우려에도 불구하고 장기적인 관점에서 재생에너지 전환이 경제적 효율성과 환경적 지속 가능성을 모두 충족시킬 수 있다고 강조한다. 
        실제로 2024년 독일과 덴마크는 풍력 기반 전력 생산 비중이 60%를 넘어섰고, 해당 지역의 전기요금 안정화에도 긍정적인 영향을 주었다.

        또한, 미국 캘리포니아주는 올해부터 모든 신규 주택에 태양광 패널 설치를 의무화했고, 중국도 서부 사막 지역을 중심으로 대규모 태양광 단지를 조성 중이다. 
        이러한 움직임은 단순한 환경 보호 차원을 넘어, 에너지 안보와 국제 경쟁력 확보 차원에서도 중요한 전략으로 여겨지고 있다.

        결론적으로, 단기적인 부담은 존재하지만 신재생에너지 중심의 정책 변화는 거스를 수 없는 세계적 흐름으로 자리 잡고 있으며, 향후 각국의 기술 혁신과 제도적 뒷받침이 그 성공 여부를 좌우할 것으로 보인다.
        
        - 선택 이유 
            - 중복 설명: “경제적 효율성”, “전기요금 안정화”, “국제 경쟁력 확보” 등 비슷한 논지가 반복됨
	        - 핵심은 후반부: “결론적으로 ~“ 이후에 정책의 방향성과 전망이 명확히 나옴
	        - 데이터 분산: 독일/덴마크, 미국, 중국의 사례가 흩어져 있음 → 요약에서 잘 정리되면 차이가 확연히 드러남


    - 셀 출력 (원래 한 줄로 출력되나 가시성을 위해 줄바꿈함)
        - 📄 요약 결과:
        2025년 상반기, 에너지 가격 급등으로 각국은 신재생에너지 전환을 가속화하고 있으며, 
        유럽연합은 풍력 및 태양광 에너지 비율을 50% 이상으로 늘리겠다고 발표했다. 전문가들은 
        재생에너지 전환이 경제적 효율성과 환경적 지속 가능성을 충족할 것이라고 강조하며, 
        독일과 덴마크는 이미 풍력 전력 생산 비중이 60%를 초과했다. 캘리포니아주는 모든 신규 주택에 
        태양광 패널 설치를 의무화하고, 중국은 대규모 태양광 단지를 조성 중이다. 이러한 변화는 에너지 안보와 
        국제 경쟁력 확보의 중요한 전략으로 자리 잡고 있으며, 신재생에너지 중심의 정책 변화는 세계적 흐름으로 확산되고 있다. 
        향후 기술 혁신과 제도적 지원이 성공 여부를 결정할 것으로 보인다.

    """